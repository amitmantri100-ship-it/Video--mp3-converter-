<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Video to MP3 Converter</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body{
  margin:0;
  font-family:Poppins, sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.card{
  background:#fff;
  padding:30px;
  border-radius:14px;
  width:92%;
  max-width:420px;
  text-align:center;
  box-shadow:0 12px 30px rgba(0,0,0,.25);
}
h1{margin:0 0 15px;}
input{margin:15px 0;}
button{
  background:#2c5364;
  color:#fff;
  border:0;
  padding:12px 22px;
  border-radius:8px;
  font-size:16px;
  cursor:pointer;
}
button:hover{opacity:.9}
.progress-container{
  width:100%;
  background:#eee;
  border-radius:5px;
  margin-top:15px;
  height:10px;
  display:none;
}
.progress-bar{
  width:0%;
  height:100%;
  background:#2c5364;
  border-radius:5px;
}
small{display:block;margin-top:10px;color:#666}
</style>
</head>
<body>

<div class="card">
  <h1>Video â†’ MP3</h1>
  <form id="f">
    <input type="file" name="video" accept="video/*" required />
    <br/>
    <button>Convert to MP3</button>
  </form>
  <div class="progress-container">
    <div class="progress-bar"></div>
  </div>
  <small id="msg"></small>
</div>

<script>
const f = document.getElementById('f');
const msg = document.getElementById('msg');
const progressContainer = document.querySelector('.progress-container');
const progressBar = document.querySelector('.progress-bar');

f.addEventListener('submit', async (e)=>{
  e.preventDefault();
  progressContainer.style.display = 'block';
  progressBar.style.width = '0%';
  msg.textContent = "Converting... please wait";

  const fd = new FormData(f);

  const res = await fetch('/convert',{
    method:'POST',
    body:fd
  });

  const blob = await res.blob();
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = "converted.mp3";
  a.click();

  progressBar.style.width = '100%';
  msg.textContent = "Done! Download started.";
});
</script>

</body>
</html>
